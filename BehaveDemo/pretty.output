Feature: User Authentication # features/login.feature:1
  As a registered user
  I want to log into my account
  So that I can access my personalized dashboard
  Feature: User Authentication  # features/login.feature:1

  Scenario Outline: Successful login with valid credentials -- @1.1 Valid Credentials  # features/login.feature:29
    Given the application is running                                                   # features/steps/login_steps.py:14
    And the test database is seeded with users                                         # features/steps/login_steps.py:31
    Given the user is on the login page                                                # features/steps/login_steps.py:37
    When the user enters username "tomsmith"                                           # features/steps/login_steps.py:49
    And the user enters password "SuperSecretPassword!"                                # features/steps/login_steps.py:61
    And the user clicks the login button                                               # features/steps/login_steps.py:73
    Then the "success message" should be displayed                                     # features/steps/login_steps.py:106
    And the user should be on the "secure" page                                        # features/steps/login_steps.py:124

  Scenario Outline: Successful login with valid credentials -- @2.1 Invalid Credentials  # features/login.feature:34
    Given the application is running                                                     # features/steps/login_steps.py:14
    And the test database is seeded with users                                           # features/steps/login_steps.py:31
    Given the user is on the login page                                                  # features/steps/login_steps.py:37
    When the user enters username "tomsmith"                                             # features/steps/login_steps.py:49
    And the user enters password "wrongpassword"                                         # features/steps/login_steps.py:61
    And the user clicks the login button                                                 # features/steps/login_steps.py:73
    Then the "error message" should be displayed                                         # features/steps/login_steps.py:106
    And the user should be on the "login" page                                           # features/steps/login_steps.py:124

  Scenario Outline: Successful login with valid credentials -- @2.2 Invalid Credentials  # features/login.feature:35
    Given the application is running                                                     # features/steps/login_steps.py:14
    And the test database is seeded with users                                           # features/steps/login_steps.py:31
    Given the user is on the login page                                                  # features/steps/login_steps.py:37
    When the user enters username "wronguser"                                            # features/steps/login_steps.py:49
    And the user enters password "anypassword"                                           # features/steps/login_steps.py:61
    And the user clicks the login button                                                 # features/steps/login_steps.py:73
    Then the "error message" should be displayed                                         # features/steps/login_steps.py:106
    And the user should be on the "login" page                                           # features/steps/login_steps.py:124

  Scenario Outline: Successful login with valid credentials -- @2.3 Invalid Credentials  # features/login.feature:36
    Given the application is running                                                     # features/steps/login_steps.py:14
    And the test database is seeded with users                                           # features/steps/login_steps.py:31
    Given the user is on the login page                                                  # features/steps/login_steps.py:37
    When the user enters username ""                                                     # features/steps/login_steps.py:80
    And the user enters password "somepassword"                                          # features/steps/login_steps.py:61
    And the user clicks the login button                                                 # features/steps/login_steps.py:73
    Then the "error message" should be displayed                                         # features/steps/login_steps.py:106
    And the user should be on the "login" page                                           # features/steps/login_steps.py:124

  Scenario Outline: Successful login with valid credentials -- @2.4 Invalid Credentials  # features/login.feature:37
    Given the application is running                                                     # features/steps/login_steps.py:14
    And the test database is seeded with users                                           # features/steps/login_steps.py:31
    Given the user is on the login page                                                  # features/steps/login_steps.py:37
    When the user enters username "tomsmith"                                             # features/steps/login_steps.py:49
    And the user enters password ""                                                      # features/steps/login_steps.py:92
    And the user clicks the login button                                                 # features/steps/login_steps.py:73
    Then the "error message" should be displayed                                         # features/steps/login_steps.py:106
    And the user should be on the "login" page                                           # features/steps/login_steps.py:124

@registration
Feature: User Registration # features/registration.feature:2
  As a new user
  I want to register for an account
  So that I can access the application features
  @smoke @positive
  Scenario: Successful registration with valid details  # features/registration.feature:8
    Given I am on the registration page                 # features/steps/registration_steps.py:43
    When I enter my name "John Doe"                     # features/steps/registration_steps.py:50
    And I enter my email "john.doe@example.com"         # features/steps/registration_steps.py:57
    And I enter my password "SecurePass123!"            # features/steps/registration_steps.py:63
    And I confirm my password "SecurePass123!"          # features/steps/registration_steps.py:69
    And I click the register button                     # features/steps/registration_steps.py:75
    Then I should see a success message                 # features/steps/registration_steps.py:82
    And I should receive a verification email           # features/steps/registration_steps.py:88

  @negative
  Scenario: Registration fails with mismatched passwords  # features/registration.feature:19
    Given I am on the registration page                   # features/steps/registration_steps.py:43
    When I enter my name "Jane Doe"                       # features/steps/registration_steps.py:50
    And I enter my email "jane.doe@example.com"           # features/steps/registration_steps.py:57
    And I enter my password "SecurePass123!"              # features/steps/registration_steps.py:63
    And I confirm my password "DifferentPass456!"         # features/steps/registration_steps.py:69
    And I click the register button                       # features/steps/registration_steps.py:75
    Then I should see an error "Passwords do not match"   # features/steps/registration_steps.py:95

  @negative
  Scenario: Registration fails with invalid email     # features/registration.feature:29
    Given I am on the registration page               # features/steps/registration_steps.py:43
    When I enter my name "Bob Smith"                  # features/steps/registration_steps.py:50
    And I enter my email "invalid-email"              # features/steps/registration_steps.py:57
    And I enter my password "SecurePass123!"          # features/steps/registration_steps.py:63
    And I confirm my password "SecurePass123!"        # features/steps/registration_steps.py:69
    And I click the register button                   # features/steps/registration_steps.py:75
    Then I should see an error "Invalid email format" # features/steps/registration_steps.py:95

  @data-driven
  Scenario Outline: Password validation rules -- @1.1                     # features/registration.feature:47
    Given I am on the registration page                                   # features/steps/registration_steps.py:43
    When I enter my password "short"                                      # features/steps/registration_steps.py:63
    And I click the register button                                       # features/steps/registration_steps.py:75
    Then I should see validation message "Password must be 8+ characters" # features/steps/registration_steps.py:102
      ASSERT FAILED: Expected 'Password must be 8+ characters' but got 'Passwords do not match'


  @data-driven
  Scenario Outline: Password validation rules -- @1.2                     # features/registration.feature:48
    Given I am on the registration page                                   # features/steps/registration_steps.py:43
    When I enter my password "nodigits"                                   # features/steps/registration_steps.py:63
    And I click the register button                                       # features/steps/registration_steps.py:75
    Then I should see validation message "Password must contain a number" # features/steps/registration_steps.py:102
      ASSERT FAILED: Expected 'Password must contain a number' but got 'Passwords do not match'


  @data-driven
  Scenario Outline: Password validation rules -- @1.3                      # features/registration.feature:49
    Given I am on the registration page                                    # features/steps/registration_steps.py:43
    When I enter my password "NOLOWERCASE"                                 # features/steps/registration_steps.py:63
    And I click the register button                                        # features/steps/registration_steps.py:75
    Then I should see validation message "Password must contain lowercase" # features/steps/registration_steps.py:102
      ASSERT FAILED: Expected 'Password must contain lowercase' but got 'Passwords do not match'


